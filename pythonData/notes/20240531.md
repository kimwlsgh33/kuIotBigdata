# Bigdata

빅데이터 -> IoT기기 센서 세팅 -> 저장 -> Data생성 -> file 메모리
-> database[MySql] -> PC, Linux[Web] -> 분석 온도

그래프 ()
numpy - 숫자타입을
pandas - serise가 모여서 DataFrame이 된다. 엑셀이라고 생각하면 됨 행과열

데이터의 분류 (수치, 범주) linear - 범주형을 수치형으로 바꿀 수 있다.

모집단, 샘플, 표본 || 회귀 chap4 - 머신러닝의 핵심

그러면 회귀란 무엇이냐?

- 2차원 데이터 표를 그리는 것, 다차원, 선형회귀.
- 범주형 실제 데이터의 위치 [범주+분류]
- 평가 -[MISS, RMSE, R2]
- 계산이 이루어 지는 방식
- 오차전파 back-prepagation

어제 이어서 CHAP4 회귀 그대로 진행

4.2.3 교차타당성검사 (Cross-Validation)

교차타당성검사는 모델의 성능을 평가하기 위한 방법으로, 데이터의 과적합(overfitting)을 방지하고 일반화 성능을 향상시키기 위해 사용됩니다. 일반적인 방법은 다음과 같습니다:

k-겹 교차타당성 (k-Fold Cross-Validation):
데이터를 k개의 부분집합(fold)으로 나누고, k번의 반복된 학습 및 평가를 통해 모델 성능을 측정합니다.
각 반복에서는 k개의 부분집합 중 하나를 검증 세트로 사용하고, 나머지 k-1개를 학습 세트로 사용합니다.
모든 k번의 반복이 끝나면 각 반복에서 얻은 평가 점수의 평균을 내어 최종 성능을 평가합니다.

이 방법의 장점은 데이터의 모든 부분이 검증 세트로 사용되기 때문에, 모델 성능 평가가 더욱 신뢰할 수 있다는 것입니다.

4.2.4 모형선택 및 단계적회귀

단계적 회귀 (Stepwise Regression)
단계적 회귀는 회귀 분석에서 독립 변수를 선택하는 방법입니다. 모델의 복잡성을 줄이고 성능을 최적화하기 위해 불필요한 변수들을 제거하거나 중요한 변수를 추가하는 방식입니다. 두 가지 주요 접근법이 있습니다:

1. 전진 선택법 (Forward Selection):
   시작할 때 모델에 변수가 없고, 하나씩 변수를 추가합니다.
   각 단계마다 가장 크게 성능이 향상되는 변수를 추가합니다.
   더 이상 성능이 유의미하게 향상되지 않을 때까지 반복합니다.
2. 후진 제거법 (Backward Elimination):
   모든 변수를 포함한 모델로 시작합니다.
   각 단계마다 가장 유의미하지 않은 변수를 제거합니다.
   더 이상 제거할 변수가 없을 때까지 반복합니다.
3. 단계적 방법 (Stepwise Method):
   전진 선택법과 후진 제거법을 결합한 방식으로, 변수를 추가할 때마다 기존 변수 중 유의미하지 않은 변수를 제거할 수도 있습니다.
   단계적 회귀는 변수 선택 과정을 자동화하여 모델의 예측 성능을 최적화하려고 합니다.

4.2.5 가중 회귀 (Weighted Regression)

가중 회귀는 데이터 포인트마다 다른 가중치를 부여하여 회귀 분석을 수행하는 방법입니다. 이 방법은 각 데이터 포인트의 중요도나 신뢰도에 따라 가중치를 다르게 적용합니다. 주요 용도는 다음과 같습니다:

1.  이상치 처리: 이상치가 있는 데이터에서 이상치의 영향을 줄이기 위해 낮은 가중치를 부여할 수 있습니다.
2.  데이터 신뢰도: 데이터 포인트마다 측정의 신뢰도가 다를 때, 신뢰도가 높은 데이터에 더 높은 가중치를 부여할 수 있습니다.
3.  시간 가중: 시간에 따라 데이터의 중요도가 달라질 때, 최근 데이터에 더 높은 가중치를 부여할 수 있습니다.

가중 회귀를 수행할 때, 회귀 모델은 가중치를 고려하여 잔차(residual)를 최소화하는 방향으로 최적화됩니다.

4.3 회귀를 이용한 예측

    **용어정리**
        -예측구간[prediction interval] : 개별예측값 주위의 불확실한 구간
        -외삽법[extrapolation] : 모델링에 사용된 데이터 범위를 벗어난 부분까지 모델을 확장하는 것

    4.3.1 외삽의 위험
    4.3.2 신뢰구간과 예측구간

4.4 회귀에서의 요인변수 [매우중요!!!]

    4.4.1 가변수 표현 (Dummy Variable Representation)

    가변수 표현은 범주형 변수를 수치형 변수로 변환하는 방법입니다. 이 방법은 범주형 변수의 각 수준(level)을 이진 변수(binary variable)로 변환하여 회귀 분석이나 다른 머신러닝 모델에 사용할 수 있도록 합니다.

    예를 들어, 범주형 변수 "색상"이 "빨강", "파랑", "초록" 세 가지 값을 가질 경우, 이를 가변수로 변환하면 다음과 같은 이진 변수로 표현할 수 있습니다:

                            빨강: [1, 0, 0]
                            파랑: [0, 1, 0]
                            초록: [0, 0, 1]

    여기서 각 가변수는 해당 범주에 속하면 1, 그렇지 않으면 0의 값을 가집니다.

    4.4.2 다수의 수준을 갖는 요인변수들 (Factors with Multiple Levels)

        다수의 수준을 갖는 요인변수는 여러 가지 범주(수준)를 갖는 범주형 변수를 의미합니다. 예를 들어, "색상"이라는 변수는 "빨강", "파랑", "초록" 등의 여러 수준을 가질 수 있습니다. 이러한 요인변수를 분석에 사용하기 위해 여러 가지 방법을 사용할 수 있습니다:

    1. 기준 부호화 (Reference Coding):
        기준 범주를 하나 설정하고 나머지 범주를 그 기준 범주와 비교합니다.
        예: "빨강"을 기준 범주로 설정하면, "파랑"과 "초록"에 대한 가변수는 [1, 0], [0, 1]로 표현되며, "빨강"은 [0, 0]으로 표현됩니다.

    2. 원-핫 인코딩 (One-Hot Encoding):
        각 범주를 독립된 이진 변수로 변환합니다.
        예: "빨강", "파랑", "초록" 각각을 독립된 변수로 표현하면 [1, 0, 0], [0, 1, 0], [0, 0, 1]로 나타냅니다.

    3. 편차 부호화 (Deviation Coding):
        각 범주가 평균 수준에서의 편차를 나타내도록 합니다.
        기준 범주(예: "빨강")를 제외한 나머지 범주를 -1, 0, 1 등의 값으로 표현하여 평균 대비 편차를 나타냅니다.

    4. 이진 부호화 (Binary Encoding):
        범주형 변수를 이진 숫자로 변환하고, 각 이진 자리수를 새로운 변수로 만듭니다.
        예: "빨강" = 1 (001), "파랑" = 2 (010), "초록" = 3 (011)으로 변환한 후, 각 자리수를 변수로 사용합니다.

        이 방법들은 모두 범주형 변수를 수치형 변수로 변환하여 분석에 사용할 수 있도록 도와줍니다. 각각의 방법은 특정 상황에 더 적합할 수 있으며, 선택하는 방법에 따라 모델의 성능과 해석이 달라질 수 있습니다.

    4.4.3 순서가 있는 요인변수 (Ordinal Factor Variable)

        "순서가 있는 요인 변수", "순서 요인 변수", "순서 범주형 변수"는 모두 순서가 있는 범주형 변수를 지칭하는 용어들입니다. 이 용어들은 데이터 과학, 통계학, 머신러닝에서 사용되는 용어로, 순서가 있는 범주형 데이터를 다루기 위해 사용됩니다.

        1. 순서가 있는 요인 변수 (Ordinal Factor)
            순서가 있는 요인 변수는 범주형 변수의 일종으로, 그 값들 사이에 순서가 존재합니다. 그러나 그 사이의 간격이 균등하지 않을 수 있습니다. 예를 들어, 교육 수준(초등학교, 중학교, 고등학교, 대학교)이나 고객 만족도(매우 불만족, 불만족, 보통, 만족, 매우 만족) 등이 이에 해당합니다. 이 변수들은 순서가 있으므로 순서 정보를 이용한 분석이 가능합니다.

        2.순서 요인 변수 (Ordinal Factor)
            순서 요인 변수는 순서가 있는 요인 변수와 같은 의미로 사용되며, 범주의 순서가 중요한 변수입니다. 순서 요인 변수는 요인 분석이나 다른 통계적 분석에서 주로 사용됩니다. 이 변수들은 범주의 순서가 관련된 데이터 분석 및 모델링에서 중요한 역할을 합니다.

        3.순서 범주형 변수 (Ordered Categorical Variable)
            순서 범주형 변수는 범주형 변수 중에서도 각 범주가 서로 비교 가능하고 순서가 있는 변수를 지칭합니다. 이러한 변수들은 수치형 변수와 유사한 성격을 가지고 있으며, 일반적으로는 수치형 변수로 취급될 수 있습니다. 예를 들어, "선호도"가 "매우 싫다", "싫다", "보통", "좋다", "매우 좋다"와 같이 순서가 있는 경우가 해당됩니다.

        이러한 용어들은 데이터 과학과 통계학에서 중요한 의미를 갖고 있으며, 순서가 있는 범주형 데이터를 이해하고 분석하는 데 사용됩니다.

    **요약**

        *순서가 있는 요인변수 (Ordered Factor Variable)
        데이터 분석에서 요인(Factor)은 범주형 변수를 의미합니다. 순서가 있는 요인변수는 이러한 범주형 변수 중에서도 순서가 있는 경우를 말합니다. 예를 들어, 교육 수준(고졸, 대졸, 석사, 박사)이나 리커트 척도(매우 동의, 동의, 보통, 반대, 매우 반대) 등이 이에 해당합니다.

        *순서요인변수 (Ordinal Factor Variable)
        이 용어는 순서가 있는 요인변수와 동일한 의미로 사용됩니다. 즉, 범주형 변수 중 순서나 등급이 있는 변수를 가리킵니다.

        *순서 범주형 변수 (Ordinal Categorical Variable)
        이 역시 순서가 있는 요인변수와 같은 의미입니다. 순서 범주형 변수는 범주 간의 순서가 중요하지만, 그 사이의 간격은 반드시 일정하지 않은 변수입니다. 예를 들어, '소득 수준'을 '낮음', '중간', '높음'으로 나눈 경우입니다.

        * 요인변수는 회귀를 위해 수치형 변수로 변환해야한다.
        * 요인변수를 p개의 개별값으로 인코딩하기 위한 가장 흔한 방법은 P-1개의 가변수를 만들어 사용하는 것이다.
        * 다수의 수준을 갖는요인 변수의 경우, 더 적은 수의 수준을 갖는 변수가 되도록 수준들을 통합해야한다.
        * 순서를갖는 요인변수의 경우, 수치형 변수로 변환하여 사용할수있다.

    4.5 회귀방정식 해석

        **용어정리**
        1.변수간 상관 (Correlation between variables):
            두 변수 간의 관련성 또는 상호 연관성을 나타냅니다. 변수간 상관은 일반적으로 피어슨 상관 계수(Pearson correlation coefficient)를 사용하여 측정됩니다. 이 값은 -1부터 1까지의 범위를 가지며, 양의 값은 양의 선형 상관 관계를, 음의 값은 음의 선형 상관 관계를 나타냅니다. 0은 상관 관계가 없음을 의미합니다.

        2.다중공선성 (Multicollinearity):
            다중공선성은 회귀 분석에서 독립 변수들 간에 높은 상관 관계가 있는 경우 발생합니다. 이는 회귀 모델에서 각 독립 변수의 영향을 정확하게 평가하는 데 어려움을 일으키며, 회귀 계수의 추정치가 불안정해지는 문제를 초래할 수 있습니다.

        3.교란변수 (Confounding variable):
            교란변수는 종속 변수와 독립 변수 간의 관계를 왜곡시키는 변수를 의미합니다. 종속 변수와 독립 변수 간의 관계를 분석할 때 통제되지 않은 교란변수가 있다면, 이것이 분석 결과에 영향을 미칠 수 있습니다.

        4.주효과 (Main effect):
            주효과는 통계적 실험에서 주로 사용되며, 각 독립 변수의 개별적인 영향을 나타냅니다. 즉, 모든 다른 변수가 고정된 상태에서 해당 독립 변수의 영향을 측정합니다.

        5.상호작용 (Interaction):
            상호작용은 두 변수 간의 관계가 다른 변수의 수준에 따라 달라지는 경우를 의미합니다. 이는 통계 모델에서 변수 간의 조합이 예측 변수의 영향을 설명하는 데 도움이 되는 경우에 중요합니다. 예를 들어, A와 B라는 두 독립 변수가 있을 때, A와 B의 상호작용은 A와 B가 함께 있을 때 종속 변수에 미치는 영향을 나타냅니다.

        4.5.1 예측변수 간 상관 (Correlation between predictor variables):
            회귀 분석에서 사용되는 예측 변수들 간의 상관 관계를 의미합니다. 이는 예측 변수들이 서로 연관되어 있을 때 발생합니다. 이러한 상관 관계는 다중공선성을 야기할 수 있으며, 모델의 해석을 어렵게 만들 수 있습니다.

        4.5.2 다중공선성 (Multicollinearity):
            다중공선성은 회귀 분석에서 예측 변수들 간에 높은 상관 관계가 있는 경우를 말합니다. 즉, 하나의 예측 변수가 다른 예측 변수들과 강한 선형 관계를 갖고 있을 때 발생합니다. 다중공선성은 회귀 분석의 결과를 왜곡시키고, 모델의 신뢰성을 저하시킬 수 있습니다.

        4.5.3 교란변수 (Confounding variable):
            교란변수는 종속 변수와 예측 변수 간의 관계를 왜곡시키는 변수를 의미합니다. 다른 변수들로 인해 예측 변수와 종속 변수 간의 관계가 오해되거나 왜곡되는 경우가 있습니다. 이를 통제하지 않으면 부정확한 결과를 얻을 수 있습니다.

        4.5.4 상호작용과 주효과 (Interaction and Main effect):
            상호작용은 두 예측 변수 간의 관계가 다른 변수의 수준에 따라 변하는 경우를 의미합니다. 즉, 한 변수의 효과가 다른 변수의 값을 고려하여 달라지는 경우입니다. 반면 주효과는 각 예측 변수의 개별 효과를 나타냅니다.

            예를 들어, A와 B라는 두 예측 변수가 있을 때, A와 B 사이의 상호작용이 있다면 A의 효과는 B의 값에 따라 변할 수 있습니다. 주효과는 A와 B의 효과가 각각 독립적으로 고려될 때를 의미합니다.

    4.6. 회귀진단
        회귀진단(Regression diagnostics)은 회귀 분석에서 모델의 적합성과 신뢰성을 평가하는 과정을 말합니다. 회귀 모델을 만들고 데이터에 적합시킨 후, 모델이 데이터를 잘 설명하고 적절히 작동하는지를 확인하기 위해 다양한 통계적 기법과 그래픽 방법을 사용합니다.

        **용어정리**
            1.표준화 잔차 (Standardized Residual): 잔차를 해당 잔차의 표준편차로 나눈 값으로, 이상치를 식별하거나 모델의 적합성을 비교하는 데 사용됩니다.
            2.특잇값 (Outlier):일반적인 데이터 패턴에서 벗어난 극단적인 값을 가진 관측치로, 회귀 분석 결과에 영향을 줄 수 있습니다.
            3.영향값 (Influence value):특정 관측치가 회귀 분석 결과에 미치는 영향의 정도를 나타내는 값으로, 해당 관측치를 제외했을 때 모델 결과가 어떻게 변하는지를 나타냅니다.
            4.지렛대(레버리지) (Leverage):특정 관측치가 회귀 모델에 미치는 영향력을 나타내며, 해당 관측치가 독립 변수들의 평균으로부터 얼마나 멀리 떨어져 있는지를 측정합니다.
            5.비정규 잔차 (Non-Normal Residual):회귀 분석의 잔차가 정규분포를 따르지 않는 경우를 의미합니다.
            6.이분산성 (Heteroscedasticity):잔차의 분산이 독립 변수들의 값에 따라서 변하는 경우를 의미합니다.
            7.편잔차 그림 (Residual Plot):회귀 모델의 적합성을 시각적으로 확인하기 위해 잔차를 가로축으로, 예측값(또는 독립 변수)을 세로축으로 하는 그래프를 말합니다.

        4.6.1 특잇값
        특잇값 (Singular Value)
            정의: 행렬의 특이값 분해(Singular Value Decomposition, SVD)에서 나오는 값들로, 행렬의 중요한 성질을 나타냄.
            용도: 데이터 압축, 차원 축소, 신호 처리 등에서 사용됨.

        극단값 (Outlier)
            정의: 데이터 분포에서 다른 관측값들과 현저히 다르게 떨어져 있는 값.
            특징: 극단값은 회귀 분석 등에서 모델의 결과에 큰 영향을 미칠 수 있으며, 종종 데이터 오류나 특이한 상황을 반영함.
            영향값: 극단값이 회귀 분석 결과에 미치는 영향을 평가한 값.

        4.6.2 영향값 (Influence Value)

            정의: 특정 데이터 포인트가 회귀 분석 결과에 미치는 영향을 측정한 값.
            특징: 높은 영향값은 해당 포인트가 모델에 큰 영향을 미친다는 것을 의미함.
        4.6.3 이분산성, 비정규성, 오차 간 상관

            *이분산성 (Heteroscedasticity)
            정의: 회귀 분석에서 오차의 분산이 일정하지 않고, 독립 변수의 값에 따라 달라지는 현상.
            특징: 이분산성이 존재하면 회귀 모델의 신뢰도가 떨어짐.

            *비정규성 (Non-normality)
            정의: 데이터의 분포가 정규분포를 따르지 않는 현상.
            특징: 회귀 분석 가정이 위배되어, 추정치와 통계적 검정이 부정확해질 수 있음.

            *오차간 상관 (Autocorrelation)
            정의: 회귀 분석에서 오차항들 간에 상관관계가 있는 현상.
            특징: 오차 간 상관이 있으면 모델의 신뢰성이 낮아지고, 예측력이 떨어짐.

        4.6.4 편잔차그림과 비선형성

        *편잔차 그림 (Partial Residual Plot)

            정의: 특정 독립 변수가 종속 변수에 미치는 효과를 시각적으로 나타낸 그래프.
            특징: 변수의 비선형성과 상호작용을 식별하는 데 유용함.

        *비선형성 (Non-linearity)

            정의: 독립 변수와 종속 변수 간의 관계가 선형이 아닌 현상.
            특징: 회귀 모델이 비선형 관계를 포착하지 못하면, 모델의 적합성이 떨어짐.

    4.7 다향회귀와 스플라인 회귀

        다항 회귀는 독립 변수와 종속 변수 간의 관계를 다항식으로 모델링합니다. 선형 회귀가 독립 변수와 종속 변수 사이의 선형 관계를 모델링하는 반면, 다항 회귀는 비선형 관계를 다항식으로 표현합니다.

        **용어정리**
            *다항 회귀 (Polynomial Regression): 독립 변수와 종속 변수 간의 비선형 관계를 다항식으로 모델링하는 기법.
            *스플라인 회귀 (Spline Regression): 데이터를 여러 구간으로 나누어 각 구간을 다항식으로 모델링하고 매끄럽게 연결하는 기법.
            *매듭 (Knot): 스플라인 회귀에서 데이터를 나누는 기준점.
            *일반화 가법 모형 (GAM): 예측 변수와 반응 변수 간의 관계를 비선형 함수의 합으로 모델링하는 유연한 통계 모형.
            *링크 함수 (Link Function): 반응 변수의 기대값과 선형 예측값을 연결하는 함수.

        * 다항 회귀 모델: 다항 회귀 모델은 위의 다항식을 사용하여 데이터를 적합시킵니다.
        예를 들어, 2차 다항 회귀는 다음과 같습니다:

                            y=a0+a1x+a2x2
        4.7.1 다항식:
        다항식은 여러 항의 합으로 구성된 수학적 표현입니다.
        일반적인 n차 다항식은 다음과 같이 나타낼 수 있습니다:

                     y=a0+a1x+a2x2+a3x3+...+anxn

        여기서 ai​는 다항식의 계수이고, xx는 독립 변수입니다.

        4.7.2 스플라인 (Spline)

        스플라인은 주어진 구간을 여러 부분으로 나누고 각 부분을 다항식으로 적합시킨 곡선입니다. 각 구간의 다항식은 매끄럽게 연결되어 전체 곡선이 부드러운 모양을 갖도록 합니다.

        * 구간 정의: 스플라인은 구간을 나누는 접점 (knots)을 기준으로 정의됩니다. 각 구간에서의 다항식은 그 구간에 있는 데이터 포인트를 적합시킵니다.
        * B-스플라인: B-스플라인은 기본 스플라인 함수로, 각 구간에서의 다항식을 표현하는 데 사용됩니다. B-스플라인은 높은 유연성과 매끄러움을 제공하며, 복잡한 데이터 패턴을 효과적으로 모델링할 수 있습니다.

        4.7.3 일반화가법모형

CHAP 5 분류 [시작!]

    5.1 나이브 베이즈

    **용어정리**
        *조건부확률(conditional probability) : 어떤 사건 (Y=i)이 주어졌을때, 해당사건(X=i)를 관찰 할 확률 p(X1|Y1)
        *사후확률(posterior probabilty) : 예측정보를 통합한 후 결과의 확률(이와 달리, 사전확률에서는 예측변수에 대한 정보를 고려하지 않는다.)

        5.1.1 나이브하지 않은 베이지분류는 왜 현실성이 없을까?
        5.1.2 나이브한해법
        5.1.3 수치형 예측변수

    5.2 판별분석
        5.2.1 공분산행렬
        5.2.2 피셔의 선형판별

    5.3 로지스틱 회귀
        5.3.1 로지스틱 반응함수와 로짓
        5.3.2 로지스틱 회귀와 GLM
        5.3.3 일반화선형모형
        5.3.4 로지스틱 회귀의 예측값
        5.3.5 계수와 오즈비 해석하기
        5.3.6 선형회귀와 룆스틱 회귀: 유사점과 차이점
